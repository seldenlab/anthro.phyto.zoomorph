[["linear-chimú-vessel-metrics.html", "Chapter 1 Linear Chimú vessel metrics 1.1 Set working directory, load data, and define variables 1.2 Boxplots for variable by group 1.3 Principal Components Analysis for group 1.4 Density plots for variable ~ group 1.5 Analyses of Variance (ANOVA) for variable ~ group", " Chapter 1 Linear Chimú vessel metrics # install required analysis packages #devtools::install_github(&quot;tidyverse/tidyverse&quot;) #devtools::install_github(&quot;mlcollyer/RRPP&quot;) #devtools::install_github(&quot;kassambara/ggpubr&quot;) #devtools::install_github(&#39;sinhrks/ggfortify&#39;) # load libraries library(here) ## here() starts at D:/github/anthro.zoo/supp library(tidyverse) ## -- Attaching packages --------------------------------------- tidyverse 1.3.1 -- ## v ggplot2 3.3.5 v purrr 0.3.4 ## v tibble 3.1.4 v dplyr 1.0.7 ## v tidyr 1.1.3 v stringr 1.4.0 ## v readr 2.0.1 v forcats 0.5.1 ## -- Conflicts ------------------------------------------ tidyverse_conflicts() -- ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(RRPP) library(ggpubr) library(ggfortify) library(cluster) library(wesanderson) library(ggExtra) 1.1 Set working directory, load data, and define variables # set working directory setwd(getwd()) data &lt;- read.csv(&quot;potmeas.csv&quot;, header = TRUE, as.is = TRUE) # define variables od &lt;- data$orifice.diameter # orifice diameter bd &lt;- data$base.diameter # base diameter nd &lt;- data$neck.diameter # neck diameter bl &lt;- data$belly.diameter # belly diameter h &lt;- data$height # height rt &lt;- data$rim.thickness # rim thickness gp &lt;- data$group # anthropomorph, phytomorph, or zoomorph 1.2 Boxplots for variable by group # boxplot of orifice diameter ~ group odgroup &lt;- ggplot(data, aes(x = gp, y = od, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Group&quot;, y = &quot;Orifice Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of base diameter ~ group bdgroup &lt;- ggplot(data, aes(x = gp, y = bd, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Group&quot;, y = &quot;Base Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of neck diameter ~ group ndgroup &lt;- ggplot(data, aes(x = gp, y = nd, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Group&quot;, y = &quot;Neck Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of belly diameter ~ group blgroup &lt;- ggplot(data, aes(x = gp, y = bl, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Group&quot;, y = &quot;Belly Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of height ~ group hgroup &lt;- ggplot(data, aes(x = gp, y = h, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Group&quot;, y = &quot;Height&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of rim thickness ~ group rtgroup &lt;- ggplot(data, aes(x = gp, y = rt, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Group&quot;, y = &quot;Rim Thick&quot;) + theme(legend.position = &quot;none&quot;) # render figure sitefigure&lt;-ggarrange(odgroup, bdgroup, ndgroup, blgroup, hgroup, rtgroup, labels = c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;), ncol = 3, nrow = 2) ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. sitefigure Figure 1.1: Boxplots of orifice diameter, base diameter, neck diameter, belly diameter, height, and rim thickness for the anthropomorphic, phytomorphic, and zoomorphic Chimú vessels used in this study. 1.3 Principal Components Analysis for group # set plot parameters to plot by group df &lt;- data[c(2:7)] pch.gps.gp &lt;- c(15,17,19)[as.factor(gp)] col.gps.gp &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(gp)] ## pca plot pca &lt;- autoplot(prcomp(df), data = data, asp = 1, shape = pch.gps.gp, colour = &quot;group&quot;, variance_percentage = TRUE, loadings = TRUE, loadings.colour = &#39;blue&#39;, loadings.label = TRUE, loadings.label.size = 3, frame = TRUE, frame.type = &#39;t&#39;) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) ggMarginal(pca, groupColour = TRUE) ## Too few points to calculate an ellipse ## Too few points to calculate an ellipse Figure 1.2: Results of Principal Components Analysis for linear metrics associated with the Chimu vessels used in this study (gray squares, anthropomorphic; orange triangles, phytomorphic; tan circles, zoomorphic). 1.4 Density plots for variable ~ group 1.4.1 Orifice diameter ~ group # density plot for orifice diameter by group Group &lt;- data$group ggplot(data, aes(x = od, fill = Group, colour = Group)) + geom_density(alpha = .5) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(0,10) + labs(x = &#39;Orifice Diameter&#39;, y = &#39;density&#39;) (#fig:density.gp.od)Density plot for orifice diameter by group. 1.4.2 Base diameter ~ group # density plot for base diameter by group ggplot(data, aes(x = bd, fill = Group, colour = Group)) + geom_density(alpha = .5) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(0,7) + labs(x = &#39;Base Diameter&#39;, y = &#39;density&#39;) (#fig:density.gp.bd)Density plot for base diameter by group. 1.4.3 Neck diameter ~ group # density plot for neck diameter by group ggplot(data, aes(x = nd, fill = Group, colour = Group)) + geom_density(alpha = .5) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(0,10) + labs(x = &#39;Neck Diameter&#39;, y = &#39;density&#39;) (#fig:density.gp.nd)Density plot for neck diameter by group. 1.4.4 Belly diameter ~ group # density plot for belly diameter by group ggplot(data, aes(x = bl, fill = Group, colour = Group)) + geom_density(alpha = .5) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(5,33) + labs(x = &#39;Belly Diameter&#39;, y = &#39;density&#39;) (#fig:density.gp.bl)Density plot for belly diameter by group. 1.4.5 Height ~ group # density plot for height by group ggplot(data, aes(x = h, fill = Group, colour = Group)) + geom_density(alpha = .5) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(8,30) + labs(x = &#39;Vessel Height&#39;, y = &#39;density&#39;) (#fig:density.gp.h)Density plot for vessel height by group. 1.5 Analyses of Variance (ANOVA) for variable ~ group 1.5.1 ANOVA Orifice diameter ~ group # anova = orifice diameter ~ group gp.od &lt;- lm.rrpp(od ~ gp, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(gp.od) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## gp 2 16.923 8.4613 0.39553 3.926 1.675 0.0448 * ## Residuals 12 25.862 2.1552 0.60447 ## Total 14 42.785 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = od ~ gp, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) # pairwise comparison of LS means = which groups differ? gp.od.pwml&lt;-pairwise(gp.od, groups = data$group) summary(gp.od.pwml, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: anthro phyto zoo ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## anthro:phyto 1.5321429 2.645107 0.6265892 0.2928 ## anthro:zoo 2.2604762 1.867452 1.9710522 0.0142 ## phyto:zoo 0.7283333 2.708333 -0.3438866 0.6338 1.5.2 ANOVA Base diameter of Chimú vessels # anova = base diameter ~ group gp.bd &lt;- lm.rrpp(bd ~ gp, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(gp.bd) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## gp 2 7.0074 3.5037 0.52258 6.5675 2.2894 0.0077 ** ## Residuals 12 6.4019 0.5335 0.47742 ## Total 14 13.4093 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = bd ~ gp, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) # pairwise comparison of LS means = which groups differ? gp.bd.pwml&lt;-pairwise(gp.bd, groups = data$group) summary(gp.bd.pwml, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: anthro phyto zoo ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## anthro:phyto 0.5357143 1.521429 0.029741 0.50640 ## anthro:zoo 1.2309524 1.050000 1.846021 0.01580 ## phyto:zoo 1.7666667 1.533333 1.708323 0.01915 1.5.3 ANOVA Neck diameter of Chimú vessels # anova = neck diameter ~ group gp.nd &lt;- lm.rrpp(nd ~ gp, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(gp.nd) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## gp 2 0.6502 0.32509 0.05255 0.3328 -0.58528 0.7231 ## Residuals 12 11.7235 0.97696 0.94745 ## Total 14 12.3737 ## ## Call: lm.rrpp(f1 = nd ~ gp, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) # pairwise comparison of LS means = which groups differ? gp.nd.pwml&lt;-pairwise(gp.nd, groups = data$group) summary(gp.nd.pwml, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: anthro phyto zoo ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## anthro:phyto 0.1392857 1.425000 -1.1783557 0.85930 ## anthro:zoo 0.4459524 1.020012 0.2914223 0.40940 ## phyto:zoo 0.3066667 1.470000 -0.5737662 0.70535 1.5.4 ANOVA Belly diameter of Chimú vessels # anova = belly diameter ~ group gp.bl &lt;- lm.rrpp(bl ~ gp, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(gp.bl) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## gp 2 83.362 41.681 0.33823 3.0666 1.3325 0.064 . ## Residuals 12 163.102 13.592 0.66177 ## Total 14 246.464 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = bl ~ gp, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) # pairwise comparison of LS means = which groups differ? gp.bl.pwml&lt;-pairwise(gp.bl, groups = data$group) summary(gp.bl.pwml, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: anthro phyto zoo ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## anthro:phyto 1.364286 6.207143 -0.5818568 0.71300 ## anthro:zoo 5.030952 4.428810 1.8022928 0.02020 ## phyto:zoo 3.666667 6.450000 0.5730024 0.31075 1.5.5 ANOVA Height of Chimú vessels # anova = height ~ group gp.h &lt;- lm.rrpp(h ~ gp, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(gp.h) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## gp 2 7.344 3.6719 0.06739 0.4336 -0.408 0.6477 ## Residuals 12 101.625 8.4688 0.93261 ## Total 14 108.969 ## ## Call: lm.rrpp(f1 = h ~ gp, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) # pairwise comparison of LS means = which groups differ? gp.h.pwml&lt;-pairwise(gp.h, groups = data$group) summary(gp.h.pwml, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: anthro phyto zoo ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## anthro:phyto 0.05714286 4.278571 -2.1888091 0.98685 ## anthro:zoo 1.44047619 3.011905 0.4105816 0.36815 ## phyto:zoo 1.38333333 4.383333 -0.1630941 0.57500 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
